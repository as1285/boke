{% extends "base.html" %}

{% block title %}个人资料 - {{ user.username }} - Flask博客{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-8">
        <div class="card shadow">
            <div class="card-header">
                <h4 class="mb-0"><i class="bi bi-person-circle"></i> 个人资料</h4>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-4 text-center">
                        <img src="{{ url_for('static', filename='uploads/' + user.avatar) }}" 
                             alt="{{ user.username }}" 
                             class="rounded-circle mb-3" 
                             width="120" height="120"
                             onerror="this.src='{{ url_for('static', filename='uploads/default_avatar.png') }}'">
                        <h5>{{ user.username }}</h5>
                        <p class="text-muted">{{ '管理员' if user.is_admin else '普通用户' }}</p>
                    </div>
                    <div class="col-md-8">
                        <table class="table table-borderless">
                            <tr>
                                <td width="30%"><strong>用户名：</strong></td>
                                <td>{{ user.username }}</td>
                            </tr>
                            <tr>
                                <td><strong>邮箱：</strong></td>
                                <td>{{ user.email }}</td>
                            </tr>
                            <tr>
                                <td><strong>个人简介：</strong></td>
                                <td>{{ user.bio or '暂无简介' }}</td>
                            </tr>
                            <tr>
                                <td><strong>个人网站：</strong></td>
                                <td>
                                    {% if user.website %}
                                    <a href="{{ user.website }}" target="_blank">{{ user.website }}</a>
                                    {% else %}
                                    暂无
                                    {% endif %}
                                </td>
                            </tr>
                            <tr>
                                <td><strong>注册时间：</strong></td>
                                <td>{{ user.created_at.strftime('%Y-%m-%d') }}</td>
                            </tr>
                            <tr>
                                <td><strong>最后登录：</strong></td>
                                <td>{{ user.last_seen.strftime('%Y-%m-%d %H:%M') if user.last_seen else '未知' }}</td>
                            </tr>
                            <tr>
                                <td><strong>发布文章：</strong></td>
                                <td>{{ user.get_post_count() }} 篇</td>
                            </tr>
                            <tr>
                                <td><strong>发表评论：</strong></td>
                                <td>{{ user.get_comment_count() }} 条</td>
                            </tr>
                        </table>
                        
                        <div class="mt-3">
                            <a href="{{ url_for('auth.edit_profile') }}" class="btn btn-primary btn-sm">
                                <i class="bi bi-pencil"></i> 编辑资料
                            </a>
                            <a href="{{ url_for('auth.change_password') }}" class="btn btn-secondary btn-sm">
                                <i class="bi bi-key"></i> 修改密码
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 我的文章 -->
        {% if posts %}
        <div class="card shadow mt-4">
            <div class="card-header">
                <h5 class="mb-0"><i class="bi bi-file-text"></i> 我的文章</h5>
            </div>
            <div class="card-body">
                <ul class="list-group list-group-flush">
                    {% for post in posts %}
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <div>
                            <a href="{{ url_for('main.post_detail', slug=post.slug) }}">{{ post.title }}</a>
                            {% if not post.is_published %}
                            <span class="badge bg-warning">草稿</span>
                            {% endif %}
                        </div>
                        <small class="text-muted">{{ post.created_at.strftime('%Y-%m-%d') }}</small>
                    </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}
